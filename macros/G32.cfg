[gcode_macro G32]
gcode:
    {% set LOCK_PROBE = params.LOCK_PROBE|default("0")|int %}
    SAVE_GCODE_STATE NAME=STATE_G32
    G90
    
    G28 X
    G28 Y
    ATTACH_PROBE_LOCK
    G28 Z
    STATUS_LEVELING
    QUAD_GANTRY_LEVEL
    G28 Z

    {% if LOCK_PROBE|int == 0 %}
        DOCK_PROBE_UNLOCK
        TOOLHEAD_MIDDLE
    {% endif %}
    RESTORE_GCODE_STATE NAME=STATE_G32


[gcode_macro HOME_LEVEL]
gcode:
    {% set LOCK_PROBE = params.LOCK_PROBE|default("0")|int %}
    SAVE_GCODE_STATE NAME=STATE_HOME_LEVEL
    G90
    
    G28 X
    G28 Y
    ATTACH_PROBE_LOCK
    G28 Z
    STATUS_LEVELING
    QUAD_GANTRY_LEVEL
    G28 Z

    {% if LOCK_PROBE|int == 0 %}
        DOCK_PROBE_UNLOCK
        TOOLHEAD_MIDDLE
    {% endif %}
    RESTORE_GCODE_STATE NAME=STATE_HOME_LEVEL